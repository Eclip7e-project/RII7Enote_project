<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anton Wall - RII7E Project</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
<style>
body{font-family:'Playfair Display', serif; background:#000; color:#fff; margin:0; padding:0; text-align:center;}
header{background:#000; border-bottom:2px solid gold; padding:20px;}
header h1{color:gold;}
section.wall{display:flex; flex-wrap:wrap; gap:16px; justify-content:center; padding:24px;}
.sticky-note{width:180px; min-height:150px; background:#fff; color:#000; border-radius:12px; padding:8px; position:relative; cursor:pointer; display:flex; flex-direction:column;}
.sticky-note img{width:100%; height:100%; object-fit:cover; border-radius:8px;}
.like-btn{margin-top:auto; padding:6px 10px; border:none; background:gold; color:#000; font-weight:700; cursor:pointer; border-radius:6px;}
.top-note{border:4px solid gold; box-shadow:0 0 12px gold;}
.delete-btn{position:absolute; top:6px; right:6px; background:red; color:#fff; border:none; border-radius:5px; padding:4px 6px; cursor:pointer;}
</style>
</head>
<body>

<header>
  <h1>Anton Wall</h1>
  <p>Your sticky notes for Anton! Click ❤ to like.</p>
</header>

<section class="wall" id="anton-wall"></section>

<script>
const wall = document.getElementById('anton-wall');
const member = 'anton';
const currentUserNotesKey = 'userNotes_' + member;

// Load notes from localStorage
function loadNotes(){
  let notes = JSON.parse(localStorage.getItem(member)||'[]');
  return notes;
}

// Save notes
function saveNotes(notes){
  localStorage.setItem(member, JSON.stringify(notes));
}

// Render wall
function renderWall(){
  const notes = loadNotes();
  wall.innerHTML='';

  // find top note
  let maxLikes = Math.max(...notes.map(n=>n.likes||0));
  
  notes.forEach(note=>{
    const div = document.createElement('div');
    div.className='sticky-note';
    if(note.likes === maxLikes && maxLikes>0) div.classList.add('top-note');
    
    div.innerHTML=`<img src="${note.img}" alt="note"><div>${note.text}</div>`;
    
    const likeBtn = document.createElement('button');
    likeBtn.className='like-btn';
    likeBtn.textContent='❤ ' + (note.likes||0);
    likeBtn.onclick=()=>{ likeNote(note.id); };
    div.appendChild(likeBtn);

    // show delete if user owns it
    const userNotes = JSON.parse(localStorage.getItem(currentUserNotesKey)||'[]');
    if(userNotes.includes(note.id)){
      const delBtn = document.createElement('button');
      delBtn.className='delete-btn';
      delBtn.textContent='Delete';
      delBtn.onclick = e=>{
        e.stopPropagation();
        deleteNote(note.id);
      };
      div.appendChild(delBtn);
    }

    wall.appendChild(div);
  });
}

// Like a note
function likeNote(id){
  let notes = loadNotes();
  let note = notes.find(n=>n.id===id);
  if(!note.likedBy) note.likedBy=[];
  const userId = localStorage.getItem('userId') || (localStorage.setItem('userId', crypto.randomUUID()), localStorage.getItem('userId'));
  if(note.likedBy.includes(userId)){ alert('Already liked!'); return; }
  note.likes = (note.likes||0)+1;
  note.likedBy.push(userId);
  saveNotes(notes);
  renderWall();
}

// Delete a note
function deleteNote(id){
  if(!confirm('Delete your note?')) return;
  let notes = loadNotes();
  notes = notes.filter(n=>n.id!==id);
  saveNotes(notes);
  let userNotes = JSON.parse(localStorage.getItem(currentUserNotesKey)||'[]');
  userNotes = userNotes.filter(nid=>nid!==id);
  localStorage.setItem(currentUserNotesKey, JSON.stringify(userNotes));
  renderWall();
}

// Example: Add a note (simulate submission)
function addSampleNote(){
  const text = prompt('Your message (max 300 chars)');
  if(!text) return;
  const img = prompt('Image filename (anton1.png etc)');
  const notes = loadNotes();
  const id = Date.now().toString(36);
  notes.push({id,img,text,likes:0,likedBy:[]});
  saveNotes(notes);
  let userNotes = JSON.parse(localStorage.getItem(currentUserNotesKey)||'[]');
  userNotes.push(id);
  localStorage.setItem(currentUserNotesKey, JSON.stringify(userNotes));
  renderWall();
}

renderWall();
</script>

<button onclick="addSampleNote()" style="margin:24px;padding:12px 16px;border-radius:8px;background:gold;color:#000;font-weight:700;">Add Note</button>

</body>
</html>

